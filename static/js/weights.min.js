var hero_type="";var build="";var gold="";var active="";var splash="";function adjustWeights(a){gtag("event","Dark Mode",{event_category:"Dark Mode",event_action:"Setting",event_label:($("#dark").prop("checked")?"Dark":"Light")});if($("#build").val()){gtag("event","Build",{event_category:"Build",event_action:"Value",event_label:$("#build").val()})}if($("#hero").val()){gtag("event","Hero",{event_category:"Hero",event_action:"Set",event_label:$("#hero").val()})}if($("#gold").val()){gtag("event","Gold",{event_category:"Gold",event_action:"Set",event_label:$("#gold").val()})}if($("#active").val()){gtag("event","Active",{event_category:"Active",event_action:"Set",event_label:$("#active").val()})}build=$("#build").val();active=("online"==$("#active").val()?true:false);splash=(true==$("#wet").prop("checked")?true:false);gold=$("#gold").val();switch($("#hero").val()){case"maya":case"kronus":case"kiki":case"beany":case"ursa":case"wally":case"pharaoh":case"cass":case"lucy":case"jazz":case"mina":hero_type="spell_ground";break;case"zato":case"sophia":case"lance":case"gulbrand":case"rhys":case"cosette":case"jayce":case"boomoh":case"aya":case"yzafa":hero_type="melee_ground";break;case"pingo":case"rosabella":case"davey":case"maddie":case"sawyer":case"saje":case"dex":case"lala":case"miki":case"finn":hero_type="ranged_ground";break;case"maple":case"nohni":hero_type="melee_flying";break;case"kin":case"zolom":hero_type="ranged_flying";break;case"titania":case"damon":hero_type="spell_flying";break}$.each(artifacts.data,function(c,b){var d=calculateWeight(c,b.expo);artifacts.data[c].rating=(0==d.rating&&0<artifacts.data.twd.level&&0==b.level?0.25:d.rating);artifacts.data[c].color=d.color});adjustBoS();if(true==a){artifacts=calculateAll(artifacts,true)}$.each(skills.data,function(c,b){var d=calculateWeight(c,b.expos.b1);skills.data[c].rating1=d.rating;skills.data[c].color=d.color;if(-1!=b.type2){d=calculateWeight(c,b.expos.b2);skills.data[c].rating2=d.rating;skills.data[c].color=determineColorWinner(skills.data[c].color,d.color)}if(-1!=b.type3){d=calculateWeight(c,b.expos.b3);skills.data[c].rating3=d.rating;skills.data[c].color=determineColorWinner(skills.data[c].color,d.color)}});calculateAllSkills();storeData()}function determineColorWinner(b,a){if("info"==a||"info"==b){return"info"}if("success"==a&&"info"!=b){return a}if("warning"==a&&"info"!=b&&"success"!=b){return a}if("secondary"==a&&"danger"==b){return a}return b}function calculateWeight(e,j){var f={rating:0,color:"danger"};if("bos"==e){f.color="info"}else{if(undefined!=j.sum){switch(j.sum){case"pet_dmg":f.rating+=pets_dmg.all;f.rating+=pets_dmg.tap*reducts.tap[build];f.rating+=pets_dmg.hero*reducts.hero[build];f.rating+=pets_dmg.splash*reducts.splash[build]*(true==splash?1:0);f.color="info";break;case"fundamental":f.rating=reducts.tap[build]+reducts.hero[build];f.color=determineColor(f.rating,true);break;case"sword_melee":f.rating=reducts.sword[build];if(-1!=hero_type.indexOf("melee")){f.rating+=reducts.hero[build]}f.color=determineColor(f.rating,true);break;case"helmet_flying":f.rating=reducts.helmet[build];if(-1!=hero_type.indexOf("flying")){f.rating+=reducts.hero[build]}f.color=determineColor(f.rating,true);break;case"gold_ground":f.rating=reducts.gold;if(-1!=hero_type.indexOf("ground")){f.rating+=reducts.hero[build]}f.color=determineColor(f.rating,true);break;case"dmg_spell":f.rating=1;if(-1!=hero_type.indexOf("spell")){f.rating+=reducts.hero[build]}f.color=determineColor(f.rating,true);break;case"companion_ranged":f.rating=reducts.companion[build];if(-1!=hero_type.indexOf("ranged")){f.rating+=reducts.hero[build]}f.color=determineColor(f.rating,true);break;case"pet_gold":f.rating+=pets_gold*reducts.gold;f.color="warning";break;case"pet_skill_phom":f.rating*=3*reducts.pet[build];if("phom"==gold||"all"==gold){f.rating=(f.rating<reducts.gold?reducts.gold:f.rating)}f.color=determineColor(f.rating,true);break;case"tree_red":f.rating+=reducts.tap[build];f.rating+=reducts.pet[build];f.rating+=reducts.fs[build];f.color=determineColor(f.rating,true);break;case"tree_yellow":f.rating+=reducts.hero[build];f.rating+=reducts.cs[build];f.rating+=reducts.wc[build];f.color=determineColor(f.rating,true);break;case"tree_blue":f.rating+=reducts.hs[build];f.rating+=reducts.gold*("phom"==gold?0.5:("fairy"==gold?0.6:1));f.rating+=reducts.sc[build];f.color=determineColor(f.rating,true);break;case"tree_green":if(0==active){f.rating+=reducts.gold;f.rating+=1}f.rating+=reducts.ds[build];f.color=determineColor(f.rating,true);break;case"skill":f.rating+=reducts.hs[build];f.rating+=reducts.ds[build];f.rating+=reducts.gold*("phom"==gold?0.5:("fairy"==gold?0.6:1));f.rating+=reducts.fs[build];f.rating+=reducts.wc[build];f.rating+=reducts.sc[build];f.color="info";break;case"skill_dmg":f.rating+=(0<reducts.hs[build]?reducts.hs[build]:0);f.rating+=(0<reducts.ds[build]?reducts.ds[build]:(0<artifacts.data.gok.level?1:0));f.rating+=(0<reducts.fs[build]?reducts.fs[build]:(0<artifacts.data.os.level?1:0));f.rating+=(0<reducts.wc[build]?reducts.wc[build]:(0<artifacts.data.tac.level?1:0));f.rating+=(0<reducts.sc[build]?reducts.sc[build]:(0<artifacts.data.ho.level?1:0));f.rating+=1;f.rating=Math.min(4,f.rating);f.color="info";break;case"artifacts":f.rating+=countArtifacts(artifacts.data);f.color="info";break;case"skill_tap":f.rating+=reducts.hs[build];f.rating+=reducts.ds[build];f.rating+=reducts.gold*("phom"==gold?0.5:("fairy"==gold?0.6:1));f.rating+=reducts.fs[build];f.rating+=reducts.wc[build];f.rating+=reducts.sc[build];f.rating*=reducts.tap[build]*("hs"==build?0:1);f.rating*=skills.data.ms.levels[Math.min(skills.data.ms.level+1,skills.data.ms.max)].bonus3;f.color=determineColor(f.rating,true);break;case"skill_fairy":f.rating+=reducts.hs[build];f.rating+=reducts.ds[build];f.rating+=reducts.gold*("phom"==gold?0.5:("fairy"==gold?0.6:1));f.rating+=reducts.fs[build];f.rating+=reducts.wc[build];f.rating+=reducts.sc[build];f.rating*=skills.data.fc.levels[Math.min(skills.data.fc.level+1,skills.data.fc.max)].bonus;if(f.rating<reducts.gold){f.rating=("fairy"==gold?reducts.gold:f.rating);f.rating=("all"==gold?reducts.gold:f.rating)}f.color=determineColor(f.rating,false);break;case"skill_mana":f.rating+=reducts.hs[build];f.rating+=reducts.ds[build];f.rating+=reducts.gold*("phom"==gold?0.5:("fairy"==gold?0.6:1));f.rating+=reducts.fs[build];f.rating+=reducts.wc[build];f.rating+=reducts.sc[build];f.rating*=(artifacts.data.op.current_effect+skills.data.mm.levels[Math.min(skills.data.mm.level+1,skills.data.mm.max)].bonus3)*0.5;f.color=determineColor(f.rating,false);break;case"skill_gold":f.rating+=(0<reducts.hs[build]?reducts.gold:(0<artifacts.data.ip.level?reducts.gold:0));f.rating+=(0<reducts.ds[build]?reducts.gold:(0<artifacts.data.gok.level?reducts.gold:0));f.rating+=(0<reducts.fs[build]?reducts.gold:(0<artifacts.data.os.level?reducts.gold:0));f.rating+=(0<reducts.wc[build]?reducts.gold:(0<artifacts.data.tac.level?reducts.gold:0));f.rating+=(0<reducts.sc[build]?reducts.gold:(0<artifacts.data.ho.level?reducts.gold:0));f.rating=(3*reducts.gold<f.rating?3*reducts.gold:f.rating);f.rating+=reducts.gold;f.color="warning";break;case"equip":f.rating+=reducts.sword[build];f.rating+=reducts.helmet[build];f.rating+=reducts.gold;f.rating+=1;f.rating+=reducts.companion[build];f.color="info";break;case"ash":if("cs"!=build){f.rating=1}else{var b=20;var a=30;var i=30;i+=(artifacts.data.a.effect*artifacts.data.a.level);i*=(0<skills.data.ds.level?1+skills.data.ds.levels[skills.data.ds.level].bonus2:1);b+=(0<skills.data.coo.level?skills.data.coo.levels[skills.data.coo.level].bonus2:0);var h=i/(a+b);var g=i/4.5;var d=((1/240)*(0<skills.data.aas.level?skills.data.aas.levels[skills.data.aas.level].bonus:1))*6;var c=d*(0<skills.data.as.level?skills.data.as.levels[skills.data.as.level].bonus2:1);f.rating=Math.min(0.5,(h/g)+c)}f.color=determineColor(f.rating,false);break}}else{if(undefined!=j.flat){switch(j.flat){case"gold":f.rating=reducts.gold;f.color="warning";break;case"hom":f.rating=reducts.gold*("phom"==gold?0.5:("fairy"==gold?0.6:1));f.color="warning";break;case"inactive_coc":if(0==active){f.rating=1;f.color="success"}else{if("coc"==gold||"all"==gold){f.rating=reducts.gold;f.color="warning"}}break;case"none":f.rating=0;f.color="danger";break;case"inactive_phom":if(0==active){f.rating=1;f.color="success"}else{f.rating=reducts.gold*(("phom"==gold||"all"==gold)?1:0);f.color="warning"}break;case"dmg":f.rating=1;f.color="info";break;case"hsk":f.rating=0;f.color="danger";break;case"active":if(1==active){f.rating=1;f.color="info"}else{f.rating=0;f.color="danger"}break;case"inactive_all":if(0==active){f.rating=1}else{f.rating=0}f.rating+=1;f.color="info";break;case"inactive":if(0==active){f.rating=1;f.color="success"}else{f.rating=0;f.color="danger"}break;case"inactive_pet":if(0==active){f.rating=reducts.pet[build];f.color=determineColor(f.rating,true)}break;case"inactive_ship":if(0==active){f.rating=reducts.cs[build];f.color=determineColor(f.rating,true)}break;case"inactive_clone":if(0==active){f.rating=reducts.sc[build];f.color=determineColor(f.rating,true)}break}}else{if(undefined!=j.reduct){if("splash"==j.reduct&&false==splash){f.rating=0}else{f.rating=reducts[j.reduct][build]}f.color=determineColor(f.rating,true);if("warning"==f.color&&"ss"==e){f.color="secondary"}}else{if(undefined!=j.hero_type){if(-1==hero_type.indexOf(j.hero_type)){f.rating=0}else{f.rating=reducts.hero[build]}f.color=determineColor(f.rating,true)}else{if(undefined!=j.gold){$.each(j.gold,function(l,k){if(gold==k){f.rating=reducts.gold;return false}else{if("partial_inactive"==k){if(!active){f.rating=reducts.gold*0.5;return false}}else{if("inactive"==k){if(!active){f.rating=reducts.gold;return false}}else{if("inactive_all"==k){if(!active){f.rating=reducts.gold}f.rating+=reducts.gold;return false}else{if("active"==k){if(active){f.rating=reducts.gold;return false}}}}}}});f.color=determineColor(f.rating,true)}}}}}}return f}function determineColor(b,a){if(reducts.gold==b){return"warning"}else{if(1==b){return"success"}else{if(1<b&&false==a){return"info"}else{if(1<b&&true==a){return"success"}else{if(0==b){return"danger"}else{return"secondary"}}}}}};